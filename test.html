<!DOCTYPE html>
<meta charset="utf-8">
<title>Test Suite</title>
<link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-2.18.0.css">
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
  <script src="https://code.jquery.com/qunit/qunit-2.18.0.js"></script>
  <script type="text/javascript" src="js/parser.js"></script>

  <script>

    const { test } = QUnit;

    QUnit.module( "Parsing", hooks => {
        let parser;

        let HEADING = [
            [ "EXT. BRICK'S POOL - DAY",
              { INT: false, EXT: true, location: ["BRICK'S POOL"], others: ["DAY"], line: "EXT. BRICK'S POOL – DAY" } ],
            [ ".SNIPER SCOPE POV",
              { INT: false, EXT: false, location: ["SNIPER SCOPE POV"], others: [], line: "SNIPER SCOPE POV" } ],
            [ "ext. brick's pool - day",
                { INT: false, EXT: true, location: ["brick's pool"], others: ["day"], line: "EXT. brick's pool – day" } ],
            [ "INT. HOUSE - DAY #1#    ",
                { INT: true, EXT: false, location: ["HOUSE"], others: ["DAY"], line: "INT. HOUSE – DAY #1#" } ],
            [ "Ext. HOUSE - DAY #1A#",
                { INT: false, EXT: true, location: ["HOUSE"], others: ["DAY"], line: "EXT. HOUSE – DAY #1A#" } ],
            [ "EST. HOUSE - DAY #1a#",
                { INT: false, EXT: true, location: ["HOUSE"], others: ["DAY"], line: "EXT. HOUSE – DAY #1a#"} ],
            [ "INT./EXT HOUSE - DAY #A1#",
                { INT: true, EXT: true, location: ["HOUSE"], others: ["DAY"], line: "INT/EXT. HOUSE – DAY #A1#"} ],
            [ "INT/EXT HOUSE - DAY #I-1-A#",
                { INT: true, EXT: true, location: ["HOUSE"], others: ["DAY"], line: "INT/EXT. HOUSE – DAY #I-1-A#" } ],
            [ "I/E HOUSE  -   DAY #1.#",
                { INT: true, EXT: true, location: ["HOUSE"], others: ["DAY"], line: "INT/EXT. HOUSE – DAY #1.#" } ],
            [ "INT. HOUSE - DAY - FLASHBACK (1944) #110A#    ",
                { INT: true, EXT: false, location: ["HOUSE"], others: ["DAY", "FLASHBACK (1944)"], line: "INT. HOUSE – DAY – FLASHBACK (1944) #110A#" } ],
            [ "EXT/INT  Espace/forêt/Appartement de HC - Nuit",
                { INT: true, EXT: true, location: ["Espace", "forêt", "Appartement de HC"], others: ["Nuit"], line: "INT/EXT. Espace/forêt/Appartement de HC – Nuit" } ],
            [ "EXT. STUDIO DE TOURNAGE - JOUR",
                { INT: true, EXT: false, location: ["STUDIO DE TOURNAGE"], others: ["JOUR"], line: "EXT. STUDIO DE TOURNAGE – JOUR"} ],
            [ ".Générique de fin",
                { INT: false, EXT: false, location: ["Générique de fin"], others: [], line: "Générique de fin"} ]
        ];

        hooks.beforeEach( () => {
            parser = new FountainParser(undefined, undefined);
        });

        test.each( "isHeading", HEADING, ( assert, [data] ) => {
            assert.true(parser.isHeading(data), `${data} is Heading`);
        });

        test.each( "isHeading (escaped)", HEADING, ( assert, [data, ...rest] ) => {
            assert.false(parser.isHeading('!' + data), `!${data} is Heading`);
        });

        test.each( "parseHeading", HEADING, ( assert, [data, expected] ) => {
            var actual = parser.parseHeading(data);
            assert.equal(actual.line, expected.line, `${actual.line} is not correctly formated`);
            assert.deepEqual(actual.location, expected.location, `location of ${actual.line} is not correct`);
        });
    });
  </script>
</body>
